#pragma once
#include <cmath>
#include <linalgwrap/MultiVector.hh>

namespace gint {
namespace tests {

/** Sturmian test data for
 * k = 1.3, Z = 4, n_max = 3, l_max = 2
 */
template <typename StoredMatrix>
struct SturmianTestData {
  typedef StoredMatrix stored_matrix_type;
  typedef typename stored_matrix_type::vector_type vector_type;
  typedef linalgwrap::MultiVector<vector_type> mulvector_type;

  static const double Z;
  static const double k_exp;

  static const stored_matrix_type Sref;
  static const stored_matrix_type V0ref;
  static const stored_matrix_type Tref;
  static const mulvector_type coeffref_bo_1;
  static const stored_matrix_type Jref_for_coeff_1;
  static const stored_matrix_type Kref_for_coeff_1;
  static const mulvector_type coeffref_bo_2;
  static const stored_matrix_type Jref_for_coeff_2;
  static const stored_matrix_type Kref_for_coeff_2;
};

template <typename StoredMatrix>
const double SturmianTestData<StoredMatrix>::Z = 4.;
template <typename StoredMatrix>
const double SturmianTestData<StoredMatrix>::k_exp = 1.3;

template <typename StoredMatrix>
const StoredMatrix SturmianTestData<StoredMatrix>::Sref{
      {1., -0.5, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
      {-0.5, 1., 0., 0., 0., -0.5, 0., 0., 0., 0., 0., 0., 0., 0.},
      {0., 0., 1., 0., 0., 0., -0.4082482904638631, 0., 0., 0., 0., 0., 0., 0.},
      {0., 0., 0., 1., 0., 0., 0., -0.4082482904638631, 0., 0., 0., 0., 0., 0.},
      {0., 0., 0., 0., 1., 0., 0., 0., -0.4082482904638631, 0., 0., 0., 0., 0.},
      {0., -0.5, 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0.},
      {0., 0., -0.4082482904638631, 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.},
      {0., 0., 0., -0.4082482904638631, 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.},
      {0., 0., 0., 0., -0.4082482904638631, 0., 0., 0., 1., 0., 0., 0., 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.}};

template <typename StoredMatrix>
const StoredMatrix SturmianTestData<StoredMatrix>::V0ref{
      {-5.2, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
      {0., -2.6, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
      {0., 0., -2.6, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
      {0., 0., 0., -2.6, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
      {0., 0., 0., 0., -2.6, 0., 0., 0., 0., 0., 0., 0., 0., 0.},
      {0., 0., 0., 0., 0., -1.7333333333333334, 0., 0., 0., 0., 0., 0., 0., 0.},
      {0., 0., 0., 0., 0., 0., -1.7333333333333334, 0., 0., 0., 0., 0., 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., -1.7333333333333334, 0., 0., 0., 0., 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., -1.7333333333333334, 0., 0., 0., 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., -1.7333333333333334, 0., 0., 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -1.7333333333333334, 0., 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -1.7333333333333334, 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -1.7333333333333334, 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       -1.7333333333333334}};

template <typename StoredMatrix>
const StoredMatrix SturmianTestData<StoredMatrix>::Tref{
      {0.8450000000000001, 0.42250000000000004, 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0.},
      {0.42250000000000004, 0.8450000000000001, 0., 0., 0., 0.42250000000000004,
       0., 0., 0., 0., 0., 0., 0., 0.},
      {0., 0., 0.8450000000000001, 0., 0., 0., 0.3449698054419643, 0., 0., 0.,
       0., 0., 0., 0.},
      {0., 0., 0., 0.8450000000000001, 0., 0., 0., 0.3449698054419643, 0., 0.,
       0., 0., 0., 0.},
      {0., 0., 0., 0., 0.8450000000000001, 0., 0., 0., 0.3449698054419643, 0.,
       0., 0., 0., 0.},
      {0., 0.42250000000000004, 0., 0., 0., 0.8450000000000001, 0., 0., 0., 0.,
       0., 0., 0., 0.},
      {0., 0., 0.3449698054419643, 0., 0., 0., 0.8450000000000001, 0., 0., 0.,
       0., 0., 0., 0.},
      {0., 0., 0., 0.3449698054419643, 0., 0., 0., 0.8450000000000001, 0., 0.,
       0., 0., 0., 0.},
      {0., 0., 0., 0., 0.3449698054419643, 0., 0., 0., 0.8450000000000001, 0.,
       0., 0., 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0.8450000000000001, 0., 0., 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.8450000000000001, 0., 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.8450000000000001, 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.8450000000000001, 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.8450000000000001}};

template <typename StoredMatrix>
const typename SturmianTestData<StoredMatrix>::mulvector_type
      SturmianTestData<StoredMatrix>::coeffref_bo_1{{0.923879532511287, 0.},
                                                    {1.306562964876374, 0.},
                                                    {0., 0.},
                                                    {0., 0.},
                                                    {0., 0.919211060789804},
                                                    {0.923879532511284, 0.},
                                                    {0., 0.},
                                                    {0., 0.},
                                                    {0., 0.919211060789804},
                                                    {0., 0.},
                                                    {0., 0.},
                                                    {0., 0.},
                                                    {0., 0.},
                                                    {0., 0.}};

template <typename StoredMatrix>
const StoredMatrix SturmianTestData<StoredMatrix>::Jref_for_coeff_1{
      {1.6461720664186745, -0.33393019420099074, 0., 0., 0., -0.136195543890634,
       0., 0., 0., 0., 0., -0.012329175769432845, 0., 0.},
      {-0.33393019420099074, 0.9527229115743773, 0., 0., 0.,
       -0.18303129230082577, 0., 0., 0., 0., 0., 0.011380166562664282, 0., 0.},
      {0., 0., 1.0976364992580179, 0., 0., 0., -0.09929753645473569, 0., 0., 0.,
       0., 0., 0., 0.},
      {0., 0., 0., 1.0714823678789975, 0., 0., 0., -0.10094126861770952, 0., 0.,
       0., 0., 0., 0.},
      {0., 0., 0., 0., 1.0976364992580179, 0., 0., 0., -0.09929753645473569, 0.,
       0., 0., 0., 0.},
      {-0.136195543890634, -0.18303129230082577, 0., 0., 0., 0.6786816157367301,
       0., 0., 0., 0., 0., -0.0008955874147987672, 0., 0.},
      {0., 0., -0.09929753645473569, 0., 0., 0., 0.739710338234191, 0., 0., 0.,
       0., 0., 0., 0.},
      {0., 0., 0., -0.10094126861770952, 0., 0., 0., 0.7277503649477062, 0., 0.,
       0., 0., 0., 0.},
      {0., 0., 0., 0., -0.09929753645473569, 0., 0., 0., 0.739710338234191, 0.,
       0., 0., 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0.8003901059885025, 0., 0., 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.789484975007585, 0., 0., 0.},
      {-0.012329175769432845, 0.011380166562664282, 0., 0., 0.,
       -0.0008955874147987672, 0., 0., 0., 0., 0., 0.7858499313472792, 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.789484975007585, 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.8003901059885025}};

template <typename StoredMatrix>
const StoredMatrix SturmianTestData<StoredMatrix>::Kref_for_coeff_1{
      {0.46785466351812427, 0.1738522613859506, 0., 0., 0.,
       0.025543601076008622, 0., 0., 0., 0., 0., -0.0215742775078567, 0., 0.},
      {0.17385226138595058, 0.1960704135885669, 0., 0., 0., 0.07168060974149265,
       0., 0., 0., 0., 0., 0.008952484229934318, 0., 0.},
      {0., 0., 0.0584797792207233, 0., 0., 0., 0.021438955914484775, 0., 0., 0.,
       0., 0., 0., 0.},
      {0., 0., 0., 0.037903631304712, 0., 0., 0., 0.014217240288501722, 0., 0.,
       0., 0., 0., 0.},
      {0., 0., 0., 0., 0.31037783781078676, 0., 0., 0., 0.17552546177938994, 0.,
       0., 0., 0., 0.},
      {0.025543601076008605, 0.07168060974149262, 0., 0., 0.,
       0.05590222723241389, 0., 0., 0., 0., 0., 0.006385689060963529, 0., 0.},
      {0., 0., 0.021438955914484775, 0., 0., 0., 0.0282298451508751, 0., 0., 0.,
       0., 0., 0., 0.},
      {0., 0., 0., 0.014217240288501722, 0., 0., 0., 0.02184785532739966, 0.,
       0., 0., 0., 0., 0.},
      {0., 0., 0., 0., 0.17552546177938996, 0., 0., 0., 0.13456362424070456, 0.,
       0., 0., 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0.014949839501421064, 0., 0., 0.,
       0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.011612566884649601, 0., 0.,
       0.},
      {-0.021574277507856704, 0.008952484229934318, 0., 0., 0.,
       0.0063856890609635284, 0., 0., 0., 0., 0., 0.013622884491703275, 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.020980792322582074,
       0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0.033686290377286016}};

template <typename StoredMatrix>
const typename SturmianTestData<StoredMatrix>::mulvector_type
      SturmianTestData<StoredMatrix>::coeffref_bo_2{{-0.923879532511287, 0.},
                                                    {-1.306562964876376, 0.},
                                                    {0., 0.},
                                                    {0., 0.7819276319069837},
                                                    {0., -0.4832578532612323},
                                                    {-0.923879532511287, 0.},
                                                    {0., 0.},
                                                    {0., 0.7819276319069836},
                                                    {0., -0.4832578532612323},
                                                    {0., 0.},
                                                    {0., 0.},
                                                    {0., 0.},
                                                    {0., 0.},
                                                    {0., 0.}};

template <typename StoredMatrix>
const StoredMatrix SturmianTestData<StoredMatrix>::Jref_for_coeff_2{
      {1.6461720664186779, -0.33393019420099146, 0., 0., 0.,
       -0.13619554389063424, 0., 0., 0., 0., 0.009550138485495498,
       0.01443525042281499, -0.009550138485495498, 0.},
      {-0.33393019420099146, 0.9527229115743792, 0., 0., 0.,
       -0.18303129230082624, 0., 0., 0., 0., -0.008815039114853065,
       -0.013324131090148407, 0.008815039114853065, 0.},
      {0., 0., 1.0787111920029149, 0.011696483131190049, 0., 0.,
       -0.10048695222154413, 0.0007350993706424606, 0., 0., 0., 0., 0., 0.},
      {0., 0., 0.011696483131190047, 1.1093329823892104, -0.011696483131190049,
       0., 0.0007350993706424606, -0.09856243708409351, -0.0007350993706424606,
       0., 0., 0., 0., 0.},
      {0., 0., 0., -0.011696483131190047, 1.0787111920029149, 0., 0.,
       -0.0007350993706424606, -0.10048695222154413, 0., 0., 0., 0., 0.},
      {-0.13619554389063424, -0.18303129230082624, 0., 0., 0.,
       0.6786816157367318, 0., 0., 0., 0., 0.0006937190285177162,
       0.0010485720091843891, -0.0006937190285177162, 0.},
      {0., 0., -0.10048695222154413, 0.0007350993706424606, 0., 0.,
       0.7310560202631841, 0.005348662655532252, 0., 0., 0., 0., 0., 0.},
      {0., 0., 0.0007350993706424606, -0.09856243708409351,
       -0.0007350993706424606, 0., 0.005348662655532252, 0.7450590008897247,
       -0.005348662655532252, 0., 0., 0., 0., 0.},
      {0., 0., 0., -0.0007350993706424606, -0.10048695222154413, 0., 0.,
       -0.005348662655532252, 0.7310560202631841, 0., 0., 0., 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0.7846080521722126,
       0.006897010416433152, 0., 0., 0.},
      {0.009550138485495498, -0.008815039114853065, 0., 0., 0.,
       0.0006937190285177162, 0., 0., 0., 0.006897010416433154,
       0.7973760019157325, 0.0028156927118202927, 0., 0.},
      {0.01443525042281499, -0.013324131090148407, 0., 0., 0.,
       0.0010485720091843891, 0., 0., 0., 0., 0.0028156927118202927,
       0.8016319851635727, -0.0028156927118202927, 0.},
      {-0.009550138485495498, 0.008815039114853065, 0., 0., 0.,
       -0.0006937190285177162, 0., 0., 0., 0., 0., -0.0028156927118202927,
       0.7973760019157325, -0.006897010416433152},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -0.006897010416433154,
       0.7846080521722126}};

template <typename StoredMatrix>
const StoredMatrix SturmianTestData<StoredMatrix>::Kref_for_coeff_2{
      {0.46785466351812427, 0.17385226138595067, 0., 0., 0.,
       0.02554360107600887, 0., 0., 0., 0., 0.016711363498877276,
       0.025259604075832116, -0.016711363498877273, 0.},
      {0.17385226138595067, 0.19607041358856753, 0., 0., 0.,
       0.07168060974149308, 0., 0., 0., 0., -0.0069345644659440375,
       -0.010481751106655578, 0.006934564465944036, 0.},
      {0., 0., 0.04359073871718859, 0.009201933091058394, 0., 0.,
       0.016213273396106186, 0.0032296494107741155, 0., 0., 0., 0., 0., 0.},
      {0., 0., 0.009201933091058392, 0.24995685984757468, -0.12185416957257986,
       0., 0.0032296494107741155, 0.13616664841064655, -0.0721392297166438, 0.,
       0., 0., 0., 0.},
      {0., 0., 0., -0.12185416957257986, 0.11321364977145966, 0., 0.,
       -0.0721392297166438, 0.058801736175623995, 0., 0., 0., 0., 0.},
      {0.025543601076008907, 0.07168060974149308, 0., 0., 0.,
       0.05590222723241422, 0., 0., 0., 0., -0.004946333477434129,
       -0.007476494977529162, 0.004946333477434129, 0.},
      {0., 0., 0.01621327339610618, 0.0032296494107741155, 0., 0.,
       0.023611793931437107, 0.002854112615400598, 0., 0., 0., 0., 0., 0.},
      {0., 0., 0.0032296494107741155, 0.1361666484106466, -0.0721392297166438,
       0., 0.002854112615400598, 0.10802780314612102, -0.050408024285261525, 0.,
       0., 0., 0., 0.},
      {0., 0., 0., -0.0721392297166438, 0.05880173617562399, 0., 0.,
       -0.05040802428526153, 0.053001727641421414, 0., 0., 0., 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0.010120093198539744,
       0.0021106765283816125, 0., 0., 0.},
      {0.016711363498877276, -0.0069345644659440375, 0., 0., 0.,
       -0.004946333477434129, 0., 0., 0., 0.0021106765283816125,
       0.020806351645832572, -0.0015571853225412853, 0., 0.},
      {0.025259604075832113, -0.010481751106655578, 0., 0., 0.,
       -0.00747649497752916, 0., 0., 0., 0., -0.0015571853225412853,
       0.025231542404326932, -0.005699410898384551, 0.},
      {-0.016711363498877273, 0.006934564465944036, 0., 0., 0.,
       0.004946333477434129, 0., 0., 0., 0., 0., -0.005699410898384551,
       0.023395665474022838, -0.008035662531940619},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -0.008035662531940619,
       0.01529872085492027}};

}  // namespace tests
}  // namespace gint
