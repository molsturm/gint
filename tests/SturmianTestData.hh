#pragma once
#include <cmath>
#include <linalgwrap/MultiVector.hh>

namespace gint {
namespace tests {

/** Sturmian test data for
 * k = 1, Z = 4, n_max = 3, l_max = 2
 *
 * TODO better take a case with k != 1
 */
template <typename StoredMatrix>
struct SturmianTestData {
  typedef StoredMatrix stored_matrix_type;
  typedef typename stored_matrix_type::vector_type vector_type;
  typedef linalgwrap::MultiVector<vector_type> mulvector_type;

  static const stored_matrix_type Sref;
  static const stored_matrix_type V0ref;
  static const stored_matrix_type Tref;
  static const mulvector_type coeffref_bo_1;
  static const stored_matrix_type Jref_for_coeff_1;
  static const stored_matrix_type Kref_for_coeff_1;
  static const mulvector_type coeffref_bo_2;
  static const stored_matrix_type Jref_for_coeff_2;
  static const stored_matrix_type Kref_for_coeff_2;
};

template <typename StoredMatrix>
const StoredMatrix SturmianTestData<StoredMatrix>::Sref{
      {1, -0.5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},             // row1
      {-0.5, 1, 0, 0, 0, -0.5, 0, 0, 0, 0, 0, 0, 0, 0},          // row2
      {0, 0, 1, 0, 0, 0, -(1 / sqrt(6.)), 0, 0, 0, 0, 0, 0, 0},  // row3
      {0, 0, 0, 1, 0, 0, 0, -(1 / sqrt(6.)), 0, 0, 0, 0, 0, 0},  // row4
      {0, 0, 0, 0, 1, 0, 0, 0, -(1 / sqrt(6.)), 0, 0, 0, 0, 0},  // row5
      {0, -0.5, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0},             // row6
      {0, 0, -(1 / sqrt(6.)), 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0},  // row7
      {0, 0, 0, -(1 / sqrt(6.)), 0, 0, 0, 1, 0, 0, 0, 0, 0, 0},  // row8
      {0, 0, 0, 0, -(1 / sqrt(6.)), 0, 0, 0, 1, 0, 0, 0, 0, 0},  // row9
      {0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0},                // row10
      {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0},                // row11
      {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0},                // row12
      {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0},                // row13
      {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1}                 // row14
};

template <typename StoredMatrix>
const StoredMatrix SturmianTestData<StoredMatrix>::V0ref{
      {-4., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},       // 1
      {0., -2., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},       // 2
      {0., 0., -2., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},       // 3
      {0., 0., 0., -2., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},       // 4
      {0., 0., 0., 0., -2., 0., 0., 0., 0., 0., 0., 0., 0., 0.},       // 5
      {0., 0., 0., 0., 0., -4. / 3., 0., 0., 0., 0., 0., 0., 0., 0.},  // 6
      {0., 0., 0., 0., 0., 0., -4. / 3., 0., 0., 0., 0., 0., 0., 0.},  // 7
      {0., 0., 0., 0., 0., 0., 0., -4. / 3., 0., 0., 0., 0., 0., 0.},  // 8
      {0., 0., 0., 0., 0., 0., 0., 0., -4. / 3., 0., 0., 0., 0., 0.},  // 9
      {0., 0., 0., 0., 0., 0., 0., 0., 0., -4. / 3., 0., 0., 0., 0.},  // 10
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -4. / 3., 0., 0., 0.},  // 11
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -4. / 3., 0., 0.},  // 12
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -4. / 3., 0.},  // 13
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -4. / 3.}   // 14
};

template <typename StoredMatrix>
const StoredMatrix SturmianTestData<StoredMatrix>::Tref{
      {0.5, 0.25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},              // row1
      {0.25, 0.5, 0, 0, 0, 0.25, 0, 0, 0, 0, 0, 0, 0, 0},           // row2
      {0, 0, 0.5, 0, 0, 0, (0.5 / sqrt(6.)), 0, 0, 0, 0, 0, 0, 0},  // row3
      {0, 0, 0, 0.5, 0, 0, 0, (0.5 / sqrt(6.)), 0, 0, 0, 0, 0, 0},  // row4
      {0, 0, 0, 0, 0.5, 0, 0, 0, (0.5 / sqrt(6.)), 0, 0, 0, 0, 0},  // row5
      {0, 0.25, 0, 0, 0, 0.5, 0, 0, 0, 0, 0, 0, 0, 0},              // row6
      {0, 0, (0.5 / sqrt(6.)), 0, 0, 0, 0.5, 0, 0, 0, 0, 0, 0, 0},  // row7
      {0, 0, 0, (0.5 / sqrt(6.)), 0, 0, 0, 0.5, 0, 0, 0, 0, 0, 0},  // row8
      {0, 0, 0, 0, (0.5 / sqrt(6.)), 0, 0, 0, 0.5, 0, 0, 0, 0, 0},  // row9
      {0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5, 0, 0, 0, 0},                 // row10
      {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5, 0, 0, 0},                 // row11
      {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5, 0, 0},                 // row12
      {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5, 0},                 // row13
      {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5}                  // row14
};

template <typename StoredMatrix>
const typename SturmianTestData<StoredMatrix>::mulvector_type
      SturmianTestData<StoredMatrix>::coeffref_bo_1{{0.923879532511287, 0.},
                                                    {1.306562964876374, 0.},
                                                    {0., 0.},
                                                    {0., 0.},
                                                    {0., 0.919211060789804},
                                                    {0.923879532511284, 0.},
                                                    {0., 0.},
                                                    {0., 0.},
                                                    {0., 0.919211060789804},
                                                    {0., 0.},
                                                    {0., 0.},
                                                    {0., 0.},
                                                    {0., 0.},
                                                    {0., 0.}};

template <typename StoredMatrix>
const StoredMatrix SturmianTestData<StoredMatrix>::Jref_for_coeff_1{
      {1.2662862049374422, -0.2568693801546082, 0., 0., 0.,
       -0.10476580299279539, 0., 0., 0., 0., 0., -0.009483981361102189, 0., 0.},
      {-0.2568693801546082, 0.7328637781341363, 0., 0., 0.,
       -0.14079330176986599, 0., 0., 0., 0., 0., 0.008753974278972529, 0., 0.},
      {0., 0., 0.8443357686600137, 0., 0., 0., -0.07638272034979668, 0., 0., 0.,
       0., 0., 0., 0.},
      {0., 0., 0., 0.8242172060607672, 0., 0., 0., -0.0776471297059304, 0., 0.,
       0., 0., 0., 0.},
      {0., 0., 0., 0., 0.8443357686600137, 0., 0., 0., -0.07638272034979668, 0.,
       0., 0., 0., 0.},
      {-0.10476580299279539, -0.14079330176986599, 0., 0., 0.,
       0.5220627813359464, 0., 0., 0., 0., 0., -0.000688913395999051, 0., 0.},
      {0., 0., -0.07638272034979668, 0., 0., 0., 0.5690079524878389, 0., 0., 0.,
       0., 0., 0., 0.},
      {0., 0., 0., -0.0776471297059304, 0., 0., 0., 0.5598079730366969, 0., 0.,
       0., 0., 0., 0.},
      {0., 0., 0., 0., -0.07638272034979668, 0., 0., 0., 0.5690079524878389, 0.,
       0., 0., 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0.6156846969142328, 0., 0., 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.6072961346212192, 0., 0., 0.},
      {-0.009483981361102189, 0.008753974278972529, 0., 0., 0.,
       -0.000688913395999051, 0., 0., 0., 0., 0., 0.6044999471902147, 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.6072961346212192, 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.6156846969142328}};

template <typename StoredMatrix>
const StoredMatrix SturmianTestData<StoredMatrix>::Kref_for_coeff_1{
      {0.3598882027062494, 0.1337325087584236, 0., 0., 0., 0.019648923904622015,
       0., 0., 0., 0., 0., -0.01659559808296669, 0., 0.},
      {0.1337325087584236, 0.15082339506812836, 0., 0., 0.,
       0.055138930570378934, 0., 0., 0., 0., 0., 0.006886526330718705, 0., 0.},
      {0., 0., 0.04498444555440257, 0., 0., 0., 0.016491504549603676, 0., 0.,
       0., 0., 0., 0., 0.},
      {0., 0., 0., 0.0291566394651631, 0., 0., 0., 0.010936338683462866, 0., 0.,
       0., 0., 0., 0.},
      {0., 0., 0., 0., 0.2387521829313744, 0., 0., 0., 0.1350195859841461, 0.,
       0., 0., 0., 0.},
      {0.019648923904622036, 0.05513893057037893, 0., 0., 0.,
       0.043001713255703046, 0., 0., 0., 0., 0., 0.0049120685084334875, 0., 0.},
      {0., 0., 0.01649150454960368, 0., 0., 0., 0.021715265500673157, 0., 0.,
       0., 0., 0., 0., 0.},
      {0., 0., 0., 0.01093633868346287, 0., 0., 0., 0.0168060425595382, 0., 0.,
       0., 0., 0., 0.},
      {0., 0., 0., 0., 0.1350195859841461, 0., 0., 0., 0.10351048018515735, 0.,
       0., 0., 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0.01149987653955467, 0., 0., 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.008932743757422777, 0., 0.,
       0.},
      {-0.01659559808296669, 0.006886526330718705, 0., 0., 0.,
       0.004912068508433488, 0., 0., 0., 0., 0., 0.010479141916694822, 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.016139071017370832,
       0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0.02591253105945078}};

template <typename StoredMatrix>
const typename SturmianTestData<StoredMatrix>::mulvector_type
      SturmianTestData<StoredMatrix>::coeffref_bo_2{{-0.923879532511287, 0.},
                                                    {-1.306562964876376, 0.},
                                                    {0., 0.},
                                                    {0., 0.7819276319069837},
                                                    {0., -0.4832578532612323},
                                                    {-0.923879532511287, 0.},
                                                    {0., 0.},
                                                    {0., 0.7819276319069836},
                                                    {0., -0.4832578532612323},
                                                    {0., 0.},
                                                    {0., 0.},
                                                    {0., 0.},
                                                    {0., 0.},
                                                    {0., 0.}};

template <typename StoredMatrix>
const StoredMatrix SturmianTestData<StoredMatrix>::Jref_for_coeff_2{
      {1.2662862049374446, -0.2568693801546088, 0., 0., 0.,
       -0.10476580299279557, 0., 0., 0., 0., 0.0073462603734580755,
       0.011104038786780759, -0.0073462603734580755, 0.},
      {-0.2568693801546088, 0.7328637781341378, 0., 0., 0.,
       -0.14079330176986635, 0., 0., 0., 0., -0.0067807993191177415,
       -0.010249331607806469, 0.0067807993191177415, 0.},
      {0., 0., 0.8297778400022423, 0.008997294716300036, 0., 0.,
       -0.07729765555503398, 0.0005654610543403549, 0., 0., 0., 0., 0., 0.},
      {0., 0., 0.008997294716300036, 0.8533330633763156, -0.008997294716300036,
       0., 0.0005654610543403549, -0.07581725929545659, -0.0005654610543403549,
       0., 0., 0., 0., 0.},
      {0., 0., 0., -0.008997294716300036, 0.8297778400022423, 0., 0.,
       -0.0005654610543403549, -0.07729765555503398, 0., 0., 0., 0., 0.},
      {-0.10476580299279557, -0.14079330176986635, 0., 0., 0.,
       0.5220627813359475, 0., 0., 0., 0., 0.0005336300219367048,
       0.0008065938532187576, -0.0005336300219367048, 0.},
      {0., 0., -0.07729765555503398, 0.0005654610543403549, 0., 0.,
       0.5623507848178338, 0.004114355888870963, 0., 0., 0., 0., 0., 0.},
      {0., 0., 0.0005654610543403549, -0.07581725929545659,
       -0.0005654610543403549, 0., 0.004114355888870963, 0.5731223083767112,
       -0.004114355888870963, 0., 0., 0., 0., 0.},
      {0., 0., 0., -0.0005654610543403549, -0.07729765555503398, 0., 0.,
       -0.004114355888870963, 0.5623507848178338, 0., 0., 0., 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0.6035446555170866,
       0.005305392628025504, 0., 0., 0.},
      {0.0073462603734580755, -0.0067807993191177415, 0., 0., 0.,
       0.0005336300219367048, 0., 0., 0., 0.005305392628025504,
       0.6133661553197942, 0.002165917470630995, 0., 0.},
      {0.011104038786780759, -0.010249331607806469, 0., 0., 0.,
       0.0008065938532187576, 0., 0., 0., 0., 0.002165917470630995,
       0.6166399885873636, -0.002165917470630995, 0.},
      {-0.0073462603734580755, 0.0067807993191177415, 0., 0., 0.,
       -0.0005336300219367048, 0., 0., 0., 0., 0., -0.002165917470630995,
       0.6133661553197942, -0.005305392628025504},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -0.005305392628025504,
       0.6035446555170866}};

template <typename StoredMatrix>
const StoredMatrix SturmianTestData<StoredMatrix>::Kref_for_coeff_2{
      {0.3598882027062494, 0.13373250875842363, 0., 0., 0., 0.01964892390462219,
       0., 0., 0., 0., 0.01285489499913636, 0.019430464673717007,
       -0.01285489499913636, 0.},
      {0.13373250875842357, 0.15082339506812883, 0., 0., 0.,
       0.05513893057037924, 0., 0., 0., 0., -0.00533428035841849,
       -0.008062885466658135, 0.00533428035841849, 0.},
      {0., 0., 0.03353133747476047, 0.007078410070044918, 0., 0.,
       0.01247174876623552, 0.002484345700595473, 0., 0., 0., 0., 0., 0.},
      {0., 0., 0.007078410070044919, 0.1922745075750574, -0.0937339765942922,
       0., 0.0024843457005954725, 0.10474357570049733, -0.055491715166649073,
       0., 0., 0., 0., 0.},
      {0., 0., 0., -0.0937339765942922, 0.08708742290112283, 0., 0.,
       -0.05549171516664907, 0.04523210475047997, 0., 0., 0., 0., 0.},
      {0.01964892390462219, 0.05513893057037924, 0., 0., 0.,
       0.043001713255703275, 0., 0., 0., 0., -0.0038048719057185596,
       -0.0057511499827147435, 0.0038048719057185588, 0.},
      {0., 0., 0.012471748766235528, 0.0024843457005954725, 0., 0.,
       0.018162918408797794, 0.0021954712426158454, 0., 0., 0., 0., 0., 0.},
      {0., 0., 0.002484345700595473, 0.10474357570049732, -0.05549171516664906,
       0., 0.0021954712426158454, 0.08309831011240082, -0.03877540329635502, 0.,
       0., 0., 0., 0.},
      {0., 0., 0., -0.05549171516664907, 0.04523210475047997, 0., 0.,
       -0.038775403296355024, 0.04077055972417033, 0., 0., 0., 0., 0.},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0.007784687075799797,
       0.0016235973295243185, 0., 0., 0.},
      {0.01285489499913636, -0.00533428035841849, 0., 0., 0.,
       -0.0038048719057185596, 0., 0., 0., 0.0016235973295243185,
       0.016004885881409674, -0.0011978348634932956, 0., 0.},
      {0.019430464673717, -0.008062885466658133, 0., 0., 0.,
       -0.0057511499827147435, 0., 0., 0., 0., -0.0011978348634932956,
       0.019408878772559177, -0.004384162229526579, 0.},
      {-0.012854894999136359, 0.00533428035841849, 0., 0., 0.,
       0.0038048719057185588, 0., 0., 0., 0., 0., -0.004384162229526579,
       0.017996665749248335, -0.0061812788707235455},
      {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -0.0061812788707235455,
       0.011768246811477126}};

}  // namespace tests
}  // namespace gint
